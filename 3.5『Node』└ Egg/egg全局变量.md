


# egg全局变量

由于 egg 是多线程运行的

我认为严格意义上全局变量分为两种    （是否正确有待确认）

1.单进程内的全局变量    （user_info）
2.多进程的全局变量        (例如网站的友情链接，每个线程，每个用户看到的是公用的全局变量)



# 1.单进程内的全局变量

- app.locals
- ctx.locals

> 原 Koa 中的 ctx.state



# 2.全局的全局变量

- redis 类的外部缓存来实现


# 坑

现象：自己设置的 global 全局变量，在线上不能用

在controller中新建全局变量codeMap，绑在global上，充当全局变量。
出现错误如下：
egg  dev本地调试完全ok，但是上线就会出现codeMap中找不到获取验证码时添加的code，所以会报错

原因：

因为正式环境是多进程的





